# Hedge Grid Strategy Configuration v1

strategy:
  name: hedge_grid_v1
  instrument_id: BTCUSDT-PERP.BINANCE

# Grid Parameters (optimized for 1-minute bars and $10k account)
grid:
  grid_step_bps: 50.0  # Grid spacing in basis points (0.5%) - wider for better fills
  grid_levels_long: 7  # Number of long grid levels below mid
  grid_levels_short: 7  # Number of short grid levels above mid
  base_qty: 0.002  # Base order quantity in BTC (~$180 at $90k)
  qty_scale: 1.05  # Quantity multiplier per level (geometric scaling)

# Take Profit / Stop Loss
exit:
  tp_steps: 2  # Take profit after 2 grid steps
  sl_steps: 5  # Stop loss after 5 grid steps (reduced from 8)

# Grid Re-centering
rebalance:
  recenter_trigger_bps: 300.0  # Re-center grid if price moves 3% from mid (was 1.5%)
  max_inventory_quote: 10000.0  # Max inventory in quote currency (USDT)

# Order Execution
execution:
  maker_only: true
  use_post_only_retries: true
  retry_attempts: 3
  retry_delay_ms: 100

# Funding Rate Filter
funding:
  funding_window_minutes: 480  # 8-hour window for funding rate check
  funding_max_cost_bps: 10.0  # Max acceptable funding cost in bps per window

# Regime Detection Parameters
regime:
  adx_len: 14  # ADX period for trend strength
  ema_fast: 12  # Fast EMA period
  ema_slow: 26  # Slow EMA period
  atr_len: 14  # ATR period for volatility
  hysteresis_bps: 50.0  # Hysteresis band for regime switching (0.5%)

# Position Sizing
position:
  max_position_size: 0.1  # Max position size in BTC (reduced from 1.0)
  max_position_pct: 0.8  # Max position as fraction of account balance (80%)
  max_leverage_used: 5.0  # Max effective leverage
  emergency_liquidation_buffer: 0.15  # Keep 15% buffer from liquidation

# Placement Policy (Inventory Biasing by Regime)
policy:
  strategy: throttled-counter  # core-and-scalp or throttled-counter
  counter_levels: 5  # Number of counter-trend levels to maintain
  counter_qty_scale: 0.5  # Scale counter-trend quantities by 50%
