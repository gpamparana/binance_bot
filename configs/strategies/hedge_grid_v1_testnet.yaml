# Hedge Grid Strategy Configuration v1 - TESTNET VERSION
# Aligned with production config but adapted for testnet validation

strategy:
  name: hedge_grid_v1_testnet
  instrument_id: BTCUSDT-PERP.BINANCE

# Grid Parameters - Wider spacing for meaningful TP after fees
grid:
  grid_step_bps: 25.0  # Grid spacing in basis points (0.25%)
  grid_levels_long: 8  # Number of long grid levels below mid
  grid_levels_short: 8  # Number of short grid levels above mid (16 total)
  base_qty: 0.002  # Base order quantity in BTC (must exceed 100 USDT min notional)
  qty_scale: 1.05  # Quantity multiplier per level (5% geometric scaling)

# Take Profit / Stop Loss - Balanced R:R ~1.33:1
# TP = 3 x 25bps = 0.75% profit target (~0.55% net after fees)
# SL = 4 x 25bps = 1.00% stop loss
# Requires ~57% win rate to break even
exit:
  tp_steps: 3  # Take profit after 3 grid steps
  sl_steps: 4  # Stop loss after 4 grid steps

# Grid Re-centering
rebalance:
  recenter_trigger_bps: 100.0  # Re-center grid if price moves 1.0% from mid (4x grid_step)
  max_inventory_quote: 5000.0  # Max inventory in quote currency - conservative for testnet

# Order Execution
execution:
  maker_only: true
  use_post_only_retries: true
  retry_attempts: 3
  retry_delay_ms: 100

# Funding Rate Filter - Relaxed for testnet
funding:
  funding_window_minutes: 480  # 8-hour window for funding rate check
  funding_max_cost_bps: 20.0  # Max acceptable funding cost in bps

# Regime Detection Parameters
regime:
  adx_len: 10  # ADX period for trend strength
  ema_fast: 9  # Fast EMA period
  ema_slow: 21  # Slow EMA period
  atr_len: 10  # ATR period for volatility
  hysteresis_bps: 25.0  # Hysteresis band for regime switching

# Position Sizing - Conservative for testnet
position:
  max_position_size: 0.5  # Max position size in BTC
  max_leverage_used: 3.0  # Max effective leverage
  emergency_liquidation_buffer: 0.20  # Keep 20% buffer from liquidation

# Placement Policy (Inventory Biasing by Regime)
policy:
  strategy: throttled-counter  # core-and-scalp or throttled-counter
  counter_levels: 5  # Number of counter-trend levels (aligned with production)
  counter_qty_scale: 0.5  # Scale counter-trend quantities by 50% (aligned with production)
